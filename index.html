<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hangman</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css" type="text/css">
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12 header">
            <h1>Welcome to Sci-Fi Hangman!</h1>
        </div>
    </div>
    <div class="row">
        <div class="col-md-3 info-panel">
            <div class="row">
                <div class="col-md-12 scoreboard-panel">
                    <h2>Game Info</h2>
                    <h3>Wins: <span id="winCounter"></span></h3>
                    <h3>Losses: <span id="lossCounter"></span></h3>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 trivia-panel">
                    <h2>#FunFact!</h2>
                </div>
            </div>
        </div>
        <div class="col-md-9 game-panel">
            <div class="row">
                <div class="col-md-12 answer-box">
                    <h3>This is where the game is played</h3>
                    <span id="gameboard"></span>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 guessed-letters">
                    <h3>Letters You've Guessed: <span id="usedLetters"></span></h3>
                    <br>
                    <h3>Misses Left: <span id="missCounter"></span></h3>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    var wordBank = ["Lightsaber", "Sonic Screwdriver", "Flux Capacitor", "Neuralizer", "Hoverboard", "Proton Pack", "Phaser", "Tesla", "Farnsworth", "Planet Express", "Death Star", "TARDIS", "Replicant", "Xenomorph", "Flukeman", "Metaluna Mutant", "The Upside Down", "Sharknado", "Nostromo", "Facehugger", "Serenity", "Cube", "Soylent Green", "The Running Man", "Skynet"];
    var chosenWord;
    var guessedLetters = [];
    var gameBoard = [];
    var missesLeft;
    var wins = 0;
    var losses = 0;

    function newGame(){
        console.log("Wins: " + wins);
        console.log("Losses: " + losses);

        gameBoard.length = 0; //resets the game board
        guessedLetters.length = 0; //resets the guessed letter array
        chosenWord = wordBank[Math.floor(Math.random() * wordBank.length)]; //randomly chooses word from wordBank
        createBoard(chosenWord);
        updateGameboard(); //displays game board
        updateScoreboard();
        missesLeft = 6;
    }

    function createBoard(title) {

        for(i = 0; i < title.length; i++){
            var letter = title.charAt(i);
            if(letter !== " ") //check for spaces
            {
                gameBoard.push('_'); //if not a space, add an underscore
            }
            else{
                gameBoard.push(' '); //if IS a space, add a space
            }
        }
    }

    function checkForWin() {
        if(gameBoard.indexOf("_") === -1){ //if no underscores are left in game board
            alert("You Win!");
            wins++;
            updateGameboard();
            newGame();
        }
    }

    function checkForLoss() {
        if(missesLeft < 1){
            alert("You lose. The word was " + chosenWord);
            losses++;
            updateGameboard();
            newGame();
        }
    }

    function updateScoreboard(){
        var winText = document.getElementById("winCounter");
        var lossText = document.getElementById("lossCounter");

        winText.textContent = wins;
        lossText.textContent = losses;

    }

    function updateGameboard() {
        var gameText = document.getElementById("gameboard");
        var usedText = document.getElementById("usedLetters");
        var missText = document.getElementById("missCounter");

        gameText.textContent = gameBoard.join('');
        usedText.textContent = guessedLetters.join(',');
        missText.textContent = missesLeft;
    }


    function addToGuessedLetters(letter) {
        for (i = 0; i < guessedLetters.length; i++)
        {
            if(guessedLetters[i] === letter.toUpperCase()){ //return if guessed letter is already in array
                return;
            }
        }
        guessedLetters.push(letter.toUpperCase());
    }

    function checkUserGuess(guess) {

        if(guess > 64 && guess < 91)
        {
            var letter = String.fromCharCode(guess);

            if(chosenWord.toLowerCase().indexOf(letter.toLowerCase()) !== -1){ //if user guess is found in word

                for(i=0; i < chosenWord.length; i++){
                    if(chosenWord.charAt(i).toLowerCase() == letter.toLowerCase()){ //if user guess is equal to letter in position of i
                        gameBoard[i] = chosenWord[i]; //update game board to correct letter from word
                    }
                }
                checkForWin();
            }
            else {
                missesLeft--;
                console.log(missesLeft);
                addToGuessedLetters(letter);
                checkForLoss();
            }

            updateGameboard(); //display updated game board
            console.log("Letters you've guessed: " + guessedLetters.join(","));
        }
    }

    newGame();
    console.log("----------------------------------");
    document.onkeyup = function (event) {
        var userGuess = event.keyCode;
        checkUserGuess(userGuess);
    }

</script>
</body>
</html>